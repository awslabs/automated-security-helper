{
  "$defs": {
    "BaseFinding": {
      "additionalProperties": true,
      "description": "Base model for all security findings.",
      "properties": {
        "created_at": {
          "default": null,
          "description": "When the finding was first detected (in UTC)",
          "title": "Created At",
          "type": "string"
        },
        "description": {
          "default": null,
          "description": "Detailed description of the finding",
          "title": "Description",
          "type": "string"
        },
        "id": {
          "description": "Unique identifier for the finding",
          "minLength": 1,
          "pattern": "^[\\w-]+$",
          "title": "Id",
          "type": "string"
        },
        "location": {
          "$ref": "#/$defs/Location",
          "description": "Location information for the finding"
        },
        "metadata": {
          "additionalProperties": true,
          "default": {},
          "description": "Additional scanner-specific metadata",
          "title": "Metadata",
          "type": "object"
        },
        "remediation": {
          "default": null,
          "description": "Guidance for fixing the finding",
          "title": "Remediation",
          "type": "string"
        },
        "severity": {
          "description": "Severity level of the finding",
          "enum": [
            "CRITICAL",
            "HIGH",
            "MEDIUM",
            "LOW",
            "INFO"
          ],
          "title": "Severity",
          "type": "string"
        },
        "status": {
          "default": "OPEN",
          "description": "Current status of the finding",
          "title": "Status",
          "type": "string"
        },
        "timestamp": {
          "default": null,
          "description": "When the finding was created",
          "title": "Timestamp",
          "type": "string"
        },
        "title": {
          "description": "Title or name of the finding",
          "minLength": 1,
          "title": "Title",
          "type": "string"
        },
        "updated_at": {
          "default": null,
          "description": "When the finding was last updated (in UTC)",
          "title": "Updated At",
          "type": "string"
        }
      },
      "required": [
        "id",
        "title",
        "severity",
        "location"
      ],
      "title": "BaseFinding",
      "type": "object"
    },
    "Location": {
      "description": "Represents the location of a finding in the codebase.",
      "properties": {
        "end_line": {
          "anyOf": [
            {
              "type": "integer"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "Ending line number of the finding",
          "title": "End Line"
        },
        "file_path": {
          "description": "Path to the file containing the finding",
          "title": "File Path",
          "type": "string"
        },
        "snippet": {
          "anyOf": [
            {
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "Code snippet related to the finding",
          "title": "Snippet"
        },
        "start_line": {
          "anyOf": [
            {
              "type": "integer"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "Starting line number of the finding",
          "title": "Start Line"
        }
      },
      "required": [
        "file_path"
      ],
      "title": "Location",
      "type": "object"
    },
    "ReportMetadata": {
      "additionalProperties": true,
      "description": "Metadata for security reports.",
      "properties": {
        "description": {
          "default": null,
          "description": "Description of the tool/scan",
          "minLength": 1,
          "title": "Description",
          "type": "string"
        },
        "generated_at": {
          "default": null,
          "title": "Generated At",
          "type": "string"
        },
        "project_name": {
          "default": null,
          "description": "Name of the project being scanned",
          "minLength": 1,
          "title": "Project Name",
          "type": "string"
        },
        "report_id": {
          "default": null,
          "description": "Unique identifier for the report",
          "minLength": 1,
          "pattern": "^[\\w-]+$",
          "title": "Report Id",
          "type": "string"
        },
        "summary_stats": {
          "additionalProperties": {
            "type": "integer"
          },
          "default": {
            "critical": 0,
            "high": 0,
            "info": 0,
            "low": 0,
            "medium": 0,
            "total": 0
          },
          "description": "Summary statistics (e.g., count by severity)",
          "title": "Summary Stats",
          "type": "object"
        },
        "tool_version": {
          "default": null,
          "description": "Version of the security tool",
          "minLength": 1,
          "title": "Tool Version",
          "type": "string"
        }
      },
      "title": "ReportMetadata",
      "type": "object"
    },
    "Scanner": {
      "additionalProperties": true,
      "description": "Represents metadata about the security scanner.",
      "properties": {
        "description": {
          "default": null,
          "description": "Description of the scanner",
          "title": "Description",
          "type": "string"
        },
        "name": {
          "description": "Name of the scanner",
          "minLength": 1,
          "pattern": "^[a-zA-Z][\\w-]*$",
          "title": "Name",
          "type": "string"
        },
        "rule_id": {
          "default": null,
          "description": "Unique identifier for the scanner rule",
          "minLength": 1,
          "pattern": "^[\\w-]+$",
          "title": "Rule Id",
          "type": "string"
        },
        "type": {
          "default": "SAST",
          "description": "Type of scanner (e.g., SAST, DAST, SBOM)",
          "enum": [
            "CONTAINER",
            "DAST",
            "DEPENDENCY",
            "IAC",
            "SAST",
            "SBOM",
            "SECRETS",
            "UNKNOWN",
            "CUSTOM",
            "BANDIT",
            "CDKNAG"
          ],
          "title": "Type",
          "type": "string"
        },
        "version": {
          "default": "1.0.0",
          "description": "Version of the scanner",
          "title": "Version",
          "type": "string"
        }
      },
      "required": [
        "name"
      ],
      "title": "Scanner",
      "type": "object"
    }
  },
  "additionalProperties": true,
  "description": "Main model class for parsing security scan reports from ASH tooling.\n\nThis model is the primary interface for handling aggregated security findings from\nvarious scanners. It supports both legacy scanner formats and the newer\nscanners_used format.\n\nExample:\n\n```python\nwith open('aggregated_results.json', 'r') as f:\n    report = ASHARPModel.from_json(f.read())\nprint(f\"Found {len(report.findings)} security findings\")\nfor scanner in report.scanners_used:\n    print(f\"Used scanner: {scanner['name']} v{scanner['version']}\")\n```",
  "properties": {
    "description": {
      "default": "AWS Security Hub Aggregated Report",
      "description": "Description of the report",
      "title": "Description",
      "type": "string"
    },
    "findings": {
      "description": "List of security findings from all scanners",
      "items": {
        "$ref": "#/$defs/BaseFinding"
      },
      "title": "Findings",
      "type": "array"
    },
    "metadata": {
      "$ref": "#/$defs/ReportMetadata"
    },
    "name": {
      "default": "ASHARP Report",
      "description": "Name of the report",
      "title": "Name",
      "type": "string"
    },
    "scan_type": {
      "default": "security",
      "description": "Type of security scan",
      "title": "Scan Type",
      "type": "string"
    },
    "scanned_paths": {
      "default": [],
      "description": "The list of paths or path patterns that were scanned as part of this report.",
      "items": {
        "type": "string"
      },
      "title": "Scanned Paths",
      "type": "array"
    },
    "scanners_used": {
      "default": [],
      "description": "List of scanners used in this report",
      "items": {
        "$ref": "#/$defs/Scanner"
      },
      "title": "Scanners Used",
      "type": "array"
    },
    "timestamp": {
      "default": null,
      "description": "Timestamp of the export in UTC",
      "title": "Timestamp",
      "type": "string"
    },
    "version": {
      "default": "1.0",
      "description": "Version of the export format",
      "title": "Version",
      "type": "string"
    }
  },
  "title": "ASHARPModel",
  "type": "object"
}
