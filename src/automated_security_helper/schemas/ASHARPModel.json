{"$defs": {"BaseFinding": {"additionalProperties": true, "description": "Base model for all security findings.", "properties": {"id": {"description": "Unique identifier for the finding", "minLength": 1, "pattern": "^[\\w-]+$", "title": "Id", "type": "string"}, "title": {"description": "Title or name of the finding", "minLength": 1, "title": "Title", "type": "string"}, "severity": {"description": "Severity level of the finding", "enum": ["CRITICAL", "HIGH", "MEDIUM", "LOW", "INFO"], "title": "Severity", "type": "string"}, "location": {"$ref": "#/$defs/Location", "description": "Location information for the finding"}, "scanner": {"$ref": "#/$defs/Scanner", "description": "Information about the scanner that found the issue"}, "timestamp": {"default": "2025-04-02T07:09:42.153646Z", "description": "When the finding was created", "format": "date-time", "title": "Timestamp", "type": "string"}, "description": {"default": null, "description": "Detailed description of the finding", "title": "Description", "type": "string"}, "status": {"default": "OPEN", "description": "Current status of the finding", "title": "Status", "type": "string"}, "created_at": {"default": "2025-04-02T07:09:42.154309Z", "description": "When the finding was first detected (in UTC)", "format": "date-time", "title": "Created At", "type": "string"}, "updated_at": {"default": "2025-04-02T07:09:42.154338Z", "description": "When the finding was last updated (in UTC)", "format": "date-time", "title": "Updated At", "type": "string"}, "remediation": {"default": null, "description": "Guidance for fixing the finding", "title": "Remediation", "type": "string"}, "metadata": {"additionalProperties": true, "default": {}, "description": "Additional scanner-specific metadata", "title": "Metadata", "type": "object"}}, "required": ["id", "title", "severity", "location", "scanner"], "title": "BaseFinding", "type": "object"}, "Location": {"description": "Represents the location of a finding in the codebase.", "properties": {"file_path": {"description": "Path to the file containing the finding", "title": "File Path", "type": "string"}, "start_line": {"anyOf": [{"type": "integer"}, {"type": "null"}], "default": null, "description": "Starting line number of the finding", "title": "Start Line"}, "end_line": {"anyOf": [{"type": "integer"}, {"type": "null"}], "default": null, "description": "Ending line number of the finding", "title": "End Line"}, "snippet": {"anyOf": [{"type": "string"}, {"type": "null"}], "default": null, "description": "Code snippet related to the finding", "title": "Snippet"}}, "required": ["file_path"], "title": "Location", "type": "object"}, "ReportMetadata": {"additionalProperties": true, "description": "Metadata for security reports.", "properties": {"report_id": {"description": "Unique identifier for the report", "minLength": 1, "pattern": "^[\\w-]+$", "title": "Report Id", "type": "string"}, "tool_name": {"description": "Name of the security tool", "minLength": 1, "title": "Tool Name", "type": "string"}, "generated_at": {"default": "2025-04-02T07:09:42.157544Z", "format": "date-time", "title": "Generated At", "type": "string"}, "project_name": {"default": null, "description": "Name of the project being scanned", "minLength": 1, "title": "Project Name", "type": "string"}, "tool_version": {"default": null, "description": "Version of the security tool", "minLength": 1, "title": "Tool Version", "type": "string"}, "description": {"default": null, "description": "Description of the tool/scan", "minLength": 1, "title": "Description", "type": "string"}, "summary_stats": {"additionalProperties": {"type": "integer"}, "default": {"total": 0, "critical": 0, "high": 0, "medium": 0, "low": 0, "info": 0}, "description": "Summary statistics (e.g., count by severity)", "title": "Summary Stats", "type": "object"}}, "required": ["report_id", "tool_name"], "title": "ReportMetadata", "type": "object"}, "Scanner": {"additionalProperties": true, "description": "Represents metadata about the security scanner.", "properties": {"name": {"description": "Name of the scanner", "minLength": 1, "pattern": "^[\\w-]+$", "title": "Name", "type": "string"}, "version": {"default": "1.0.0", "description": "Version of the scanner", "title": "Version", "type": "string"}, "type": {"default": "SAST", "description": "Type of scanner (e.g., SAST, DAST, SBOM)", "enum": ["SAST", "DAST", "SBOM", "CONTAINER", "IAC", "DEPENDENCY", "VULNERABILITY", "SECURITY", "STATIC", "DYNAMIC", "SECRET"], "title": "Type", "type": "string"}, "rule_id": {"default": null, "description": "Unique identifier for the scanner rule", "minLength": 1, "pattern": "^[\\w-]+$", "title": "Rule Id", "type": "string"}, "description": {"default": null, "description": "Description of the scanner", "title": "Description", "type": "string"}}, "required": ["name"], "title": "Scanner", "type": "object"}}, "additionalProperties": false, "description": "Main model class for parsing security scan reports from ASH tooling.\n\nThis model is the primary interface for handling aggregated security findings from\nvarious scanners. It supports both legacy scanner formats and the newer\nscanners_used format.\n\nExample:\n    >>> with open('aggregated_results.json', 'r') as f:\n    ...     report = ASHARPModel.from_json(f.read())\n    >>> print(f\"Found {len(report.findings)} security findings\")\n    >>> for scanner in report.scanners_used:\n    ...     print(f\"Used scanner: {scanner['name']} v{scanner['version']}\")", "properties": {"name": {"default": "ASHARP Report", "description": "Name of the report", "title": "Name", "type": "string"}, "description": {"default": "AWS Security Hub Aggregated Report", "description": "Description of the report", "title": "Description", "type": "string"}, "timestamp": {"description": "Timestamp of the export in UTC", "format": "date-time", "title": "Timestamp", "type": "string"}, "version": {"default": "1.0", "description": "Version of the export format", "title": "Version", "type": "string"}, "metadata": {"$ref": "#/$defs/ReportMetadata"}, "findings": {"description": "List of security findings from all scanners", "items": {"$ref": "#/$defs/BaseFinding"}, "title": "Findings", "type": "array"}, "scanners_used": {"default": [], "description": "List of scanners used in this report", "items": {"$ref": "#/$defs/Scanner"}, "title": "Scanners Used", "type": "array"}, "scan_type": {"default": "security", "description": "Type of security scan", "title": "Scan Type", "type": "string"}}, "title": "ASHARPModel", "type": "object"}