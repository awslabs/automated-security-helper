{
  "$defs": {
    "ASFFReporterConfig": {
      "additionalProperties": true,
      "properties": {
        "enabled": {
          "default": false,
          "title": "Enabled",
          "type": "boolean"
        },
        "extension": {
          "default": "asff",
          "title": "Extension",
          "type": "string"
        },
        "name": {
          "const": "asff",
          "default": "asff",
          "title": "Name",
          "type": "string"
        },
        "options": {
          "$ref": "#/$defs/ScannerOptionsBase",
          "default": {
            "severity_threshold": null
          },
          "description": "Scanner options"
        }
      },
      "title": "ASFFReporterConfig",
      "type": "object"
    },
    "AshGlobalDefaultsConfigSection": {
      "additionalProperties": false,
      "properties": {
        "ignore_paths": {
          "default": [],
          "description": "Global list of IgnorePaths. Each path requires a reason for ignoring, e.g. 'Folder contains test data only and is not committed'.",
          "items": {
            "$ref": "#/$defs/IgnorePathWithReason"
          },
          "title": "Ignore Paths",
          "type": "array"
        },
        "severity_threshold": {
          "default": "MEDIUM",
          "description": "Global minimum severity level to consider findings as failures across all scanners",
          "enum": [
            "ALL",
            "LOW",
            "MEDIUM",
            "HIGH",
            "CRITICAL"
          ],
          "title": "Severity Threshold",
          "type": "string"
        }
      },
      "title": "AshGlobalDefaultsConfigSection",
      "type": "object"
    },
    "BanditScannerConfig": {
      "additionalProperties": true,
      "properties": {
        "enabled": {
          "default": true,
          "title": "Enabled",
          "type": "boolean"
        },
        "name": {
          "const": "bandit",
          "default": "bandit",
          "title": "Name",
          "type": "string"
        },
        "options": {
          "$ref": "#/$defs/BanditScannerConfigOptions",
          "default": {
            "additional_formats": [],
            "confidence_level": "all",
            "excluded_paths": [],
            "ignore_nosec": false,
            "severity_threshold": null
          },
          "description": "Configure Bandit scanner"
        }
      },
      "title": "BanditScannerConfig",
      "type": "object"
    },
    "BanditScannerConfigOptions": {
      "additionalProperties": true,
      "properties": {
        "additional_formats": {
          "default": [],
          "description": "List of additional formats to output",
          "items": {
            "enum": [
              "csv",
              "custom",
              "html",
              "json",
              "sarif",
              "txt",
              "xml",
              "yaml"
            ],
            "type": "string"
          },
          "title": "Additional Formats",
          "type": "array"
        },
        "confidence_level": {
          "default": "all",
          "description": "Confidence level for Bandit findings",
          "enum": [
            "all",
            "low",
            "medium",
            "high"
          ],
          "title": "Confidence Level",
          "type": "string"
        },
        "excluded_paths": {
          "default": [],
          "description": "List of excluded paths and their corresponding reason to exclude from scanning",
          "items": {
            "$ref": "#/$defs/IgnorePathWithReason"
          },
          "title": "Excluded Paths",
          "type": "array"
        },
        "ignore_nosec": {
          "default": false,
          "description": "If True, do not skip lines with # nosec comments. Defaults to False.",
          "title": "Ignore Nosec",
          "type": "boolean"
        },
        "severity_threshold": {
          "anyOf": [
            {
              "enum": [
                "ALL",
                "LOW",
                "MEDIUM",
                "HIGH",
                "CRITICAL"
              ],
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "Minimum severity level to consider findings as failures. This is a scanner-level override of the default severity-level within ASH of MEDIUM.",
          "title": "Severity Threshold"
        }
      },
      "title": "BanditScannerConfigOptions",
      "type": "object"
    },
    "BuildConfig": {
      "additionalProperties": true,
      "description": "Configuration model for build-time settings.",
      "properties": {
        "build_mode": {
          "default": "OFFLINE",
          "description": "Build mode for the container image build. If enabled, also enables offline mode during the scan phase without any explicit directive when scanning.",
          "enum": [
            "ONLINE",
            "OFFLINE"
          ],
          "title": "Build Mode",
          "type": "string"
        },
        "custom_scanners": {
          "default": [],
          "description": "Scanner configurations by type",
          "items": {
            "$ref": "#/$defs/ScannerPluginBase"
          },
          "title": "Custom Scanners",
          "type": "array"
        },
        "tool_install_scripts": {
          "additionalProperties": {
            "items": {
              "type": "string"
            },
            "type": "array"
          },
          "default": {},
          "description": "Map of tool names to their installation scripts",
          "title": "Tool Install Scripts",
          "type": "object"
        }
      },
      "title": "BuildConfig",
      "type": "object"
    },
    "CSVReporterConfig": {
      "additionalProperties": true,
      "properties": {
        "enabled": {
          "default": false,
          "title": "Enabled",
          "type": "boolean"
        },
        "extension": {
          "default": "csv",
          "title": "Extension",
          "type": "string"
        },
        "name": {
          "const": "csv",
          "default": "csv",
          "title": "Name",
          "type": "string"
        },
        "options": {
          "$ref": "#/$defs/ScannerOptionsBase",
          "default": {
            "severity_threshold": null
          },
          "description": "Scanner options"
        }
      },
      "title": "CSVReporterConfig",
      "type": "object"
    },
    "CdkNagPacks": {
      "additionalProperties": true,
      "properties": {
        "AwsSolutionsChecks": {
          "default": true,
          "description": "Runs the AwsSolutionsChecks NagPack included with CDK Nag.",
          "title": "Awssolutionschecks",
          "type": "boolean"
        },
        "HIPAASecurityChecks": {
          "default": false,
          "description": "Runs the HIPAASecurityChecks NagPack included with CDK Nag.",
          "title": "Hipaasecuritychecks",
          "type": "boolean"
        },
        "NIST80053R4Checks": {
          "default": false,
          "description": "Runs the NIST80053R4Checks NagPack included with CDK Nag.",
          "title": "Nist80053R4Checks",
          "type": "boolean"
        },
        "NIST80053R5Checks": {
          "default": false,
          "description": "Runs the NIST80053R5Checks NagPack included with CDK Nag.",
          "title": "Nist80053R5Checks",
          "type": "boolean"
        },
        "PCIDSS321Checks": {
          "default": false,
          "description": "Runs the PCIDSS321Checks NagPack included with CDK Nag.",
          "title": "Pcidss321Checks",
          "type": "boolean"
        }
      },
      "title": "CdkNagPacks",
      "type": "object"
    },
    "CdkNagScannerConfig": {
      "additionalProperties": true,
      "properties": {
        "enabled": {
          "default": true,
          "title": "Enabled",
          "type": "boolean"
        },
        "name": {
          "const": "cdk-nag",
          "default": "cdk-nag",
          "title": "Name",
          "type": "string"
        },
        "options": {
          "$ref": "#/$defs/CdkNagScannerConfigOptions",
          "default": {
            "nag_packs": {
              "AwsSolutionsChecks": true,
              "HIPAASecurityChecks": false,
              "NIST80053R4Checks": false,
              "NIST80053R5Checks": false,
              "PCIDSS321Checks": false
            },
            "severity_threshold": null
          },
          "description": "Configure Bandit scanner"
        }
      },
      "title": "CdkNagScannerConfig",
      "type": "object"
    },
    "CdkNagScannerConfigOptions": {
      "additionalProperties": true,
      "description": "CDK Nag IAC SAST scanner options.",
      "properties": {
        "nag_packs": {
          "$ref": "#/$defs/CdkNagPacks",
          "default": {
            "AwsSolutionsChecks": true,
            "HIPAASecurityChecks": false,
            "NIST80053R4Checks": false,
            "NIST80053R5Checks": false,
            "PCIDSS321Checks": false
          },
          "description": "CDK Nag packs to enable"
        },
        "severity_threshold": {
          "anyOf": [
            {
              "enum": [
                "ALL",
                "LOW",
                "MEDIUM",
                "HIGH",
                "CRITICAL"
              ],
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "Minimum severity level to consider findings as failures. This is a scanner-level override of the default severity-level within ASH of MEDIUM.",
          "title": "Severity Threshold"
        }
      },
      "title": "CdkNagScannerConfigOptions",
      "type": "object"
    },
    "CfnNagScannerConfig": {
      "additionalProperties": true,
      "description": "CFN Nag IAC SAST scanner configuration.",
      "properties": {
        "enabled": {
          "default": true,
          "description": "Whether the custom scanner is enabled.",
          "title": "Enabled",
          "type": "boolean"
        },
        "name": {
          "const": "cfn-nag",
          "default": "cfn-nag",
          "title": "Name",
          "type": "string"
        },
        "options": {
          "$ref": "#/$defs/ScannerOptionsBase",
          "default": {
            "severity_threshold": null
          },
          "description": "Enable CFN Nag IAC scanner"
        },
        "type": {
          "default": "IAC",
          "enum": [
            "CONTAINER",
            "DAST",
            "DEPENDENCY",
            "IAC",
            "SAST",
            "SBOM",
            "SECRETS",
            "UNKNOWN",
            "CUSTOM"
          ],
          "title": "Type",
          "type": "string"
        }
      },
      "title": "CfnNagScannerConfig",
      "type": "object"
    },
    "CheckovScannerConfig": {
      "additionalProperties": true,
      "properties": {
        "enabled": {
          "default": true,
          "title": "Enabled",
          "type": "boolean"
        },
        "name": {
          "const": "checkov",
          "default": "checkov",
          "title": "Name",
          "type": "string"
        },
        "options": {
          "$ref": "#/$defs/CheckovScannerConfigOptions",
          "default": {
            "additional_formats": [
              "cyclonedx_json"
            ],
            "config_file": null,
            "frameworks": [
              "all"
            ],
            "severity_threshold": null,
            "skip_frameworks": [],
            "skip_path": []
          },
          "description": "Configure Checkov scanner"
        }
      },
      "title": "CheckovScannerConfig",
      "type": "object"
    },
    "CheckovScannerConfigOptions": {
      "additionalProperties": true,
      "properties": {
        "additional_formats": {
          "default": [
            "cyclonedx_json"
          ],
          "description": "List of additional formats to output. Defaults to including CycloneDX JSON",
          "items": {
            "enum": [
              "cli",
              "csv",
              "cyclonedx",
              "cyclonedx_json",
              "json",
              "junitxml",
              "github_failed_only",
              "gitlab_sast",
              "sarif",
              "spdx"
            ],
            "type": "string"
          },
          "title": "Additional Formats",
          "type": "array"
        },
        "config_file": {
          "anyOf": [
            {
              "format": "path",
              "type": "string"
            },
            {
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "Path to Checkov configuration file, relative to current source directory. Defaults to searching for `.checkov.yaml` and `.checkov.yml` in the root of the source directory.",
          "title": "Config File"
        },
        "frameworks": {
          "default": [
            "all"
          ],
          "description": "Specific frameworks to include with Checkov. Defaults to `all`.",
          "items": {
            "enum": [
              "all",
              "ansible",
              "argo_workflows",
              "arm",
              "azure_pipelines",
              "bicep",
              "bitbucket_pipelines",
              "cdk",
              "circleci_pipelines",
              "cloudformation",
              "dockerfile",
              "github_configuration",
              "github_actions",
              "gitlab_configuration",
              "gitlab_ci",
              "bitbucket_configuration",
              "helm",
              "json",
              "yaml",
              "kubernetes",
              "kustomize",
              "openapi",
              "sca_package",
              "sca_image",
              "secrets",
              "serverless",
              "terraform",
              "terraform_json",
              "terraform_plan",
              "sast",
              "sast_python",
              "sast_java",
              "sast_javascript",
              "sast_typescript",
              "sast_golang",
              "3d_policy"
            ],
            "type": "string"
          },
          "title": "Frameworks",
          "type": "array"
        },
        "severity_threshold": {
          "anyOf": [
            {
              "enum": [
                "ALL",
                "LOW",
                "MEDIUM",
                "HIGH",
                "CRITICAL"
              ],
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "Minimum severity level to consider findings as failures. This is a scanner-level override of the default severity-level within ASH of MEDIUM.",
          "title": "Severity Threshold"
        },
        "skip_frameworks": {
          "default": [],
          "description": "Specific frameworks to exclude with Checkov. Defaults to none.",
          "items": {
            "enum": [
              "all",
              "ansible",
              "argo_workflows",
              "arm",
              "azure_pipelines",
              "bicep",
              "bitbucket_pipelines",
              "cdk",
              "circleci_pipelines",
              "cloudformation",
              "dockerfile",
              "github_configuration",
              "github_actions",
              "gitlab_configuration",
              "gitlab_ci",
              "bitbucket_configuration",
              "helm",
              "json",
              "yaml",
              "kubernetes",
              "kustomize",
              "openapi",
              "sca_package",
              "sca_image",
              "secrets",
              "serverless",
              "terraform",
              "terraform_json",
              "terraform_plan",
              "sast",
              "sast_python",
              "sast_java",
              "sast_javascript",
              "sast_typescript",
              "sast_golang",
              "3d_policy"
            ],
            "type": "string"
          },
          "title": "Skip Frameworks",
          "type": "array"
        },
        "skip_path": {
          "default": [],
          "description": "Path (file or directory) to skip, using regular expression logic, relative to current working directory. Word boundaries are not implicit; i.e., specifying \"dir1\" will skip any directory or subdirectory named \"dir1\". Ignored with -f. Can be specified multiple times.",
          "items": {
            "$ref": "#/$defs/IgnorePathWithReason"
          },
          "title": "Skip Path",
          "type": "array"
        }
      },
      "title": "CheckovScannerConfigOptions",
      "type": "object"
    },
    "CustomScannerConfig": {
      "additionalProperties": true,
      "description": "Custom scanner configuration.",
      "properties": {
        "enabled": {
          "default": true,
          "title": "Enabled",
          "type": "boolean"
        },
        "name": {
          "default": "custom",
          "title": "Name",
          "type": "string"
        },
        "options": {
          "$ref": "#/$defs/CustomScannerConfigOptions",
          "default": {
            "severity_threshold": null
          },
          "description": "Configure custom scanner"
        },
        "type": {
          "default": "CUSTOM",
          "enum": [
            "CONTAINER",
            "DAST",
            "DEPENDENCY",
            "IAC",
            "SAST",
            "SBOM",
            "SECRETS",
            "UNKNOWN",
            "CUSTOM"
          ],
          "title": "Type",
          "type": "string"
        }
      },
      "title": "CustomScannerConfig",
      "type": "object"
    },
    "CustomScannerConfigOptions": {
      "additionalProperties": true,
      "properties": {
        "severity_threshold": {
          "anyOf": [
            {
              "enum": [
                "ALL",
                "LOW",
                "MEDIUM",
                "HIGH",
                "CRITICAL"
              ],
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "Minimum severity level to consider findings as failures. This is a scanner-level override of the default severity-level within ASH of MEDIUM.",
          "title": "Severity Threshold"
        }
      },
      "title": "CustomScannerConfigOptions",
      "type": "object"
    },
    "CycloneDXReporterConfig": {
      "additionalProperties": true,
      "properties": {
        "enabled": {
          "default": true,
          "title": "Enabled",
          "type": "boolean"
        },
        "extension": {
          "default": "cdx.json",
          "title": "Extension",
          "type": "string"
        },
        "name": {
          "const": "cyclonedx",
          "default": "cyclonedx",
          "title": "Name",
          "type": "string"
        },
        "options": {
          "$ref": "#/$defs/ScannerOptionsBase",
          "default": {
            "severity_threshold": null
          },
          "description": "Scanner options"
        }
      },
      "title": "CycloneDXReporterConfig",
      "type": "object"
    },
    "DetectSecretsScannerConfig": {
      "additionalProperties": true,
      "properties": {
        "enabled": {
          "default": true,
          "title": "Enabled",
          "type": "boolean"
        },
        "name": {
          "const": "detect-secrets",
          "default": "detect-secrets",
          "title": "Name",
          "type": "string"
        },
        "options": {
          "$ref": "#/$defs/DetectSecretsScannerConfigOptions",
          "default": {
            "baseline_file": null,
            "scan_settings": {},
            "severity_threshold": null
          },
          "description": "Configure detect-secrets scanner"
        }
      },
      "title": "DetectSecretsScannerConfig",
      "type": "object"
    },
    "DetectSecretsScannerConfigOptions": {
      "additionalProperties": true,
      "properties": {
        "baseline_file": {
          "anyOf": [
            {
              "format": "path",
              "type": "string"
            },
            {
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "Path to detect-secrets baseline file, relative to current source directory. Defaults to searching for `.secrets.baseline` in the root of the source directory. The settings from the baseline will be overwritten if scan_settings is provided.",
          "title": "Baseline File"
        },
        "scan_settings": {
          "additionalProperties": {
            "items": {
              "additionalProperties": {
                "type": "string"
              },
              "type": "object"
            },
            "type": "array"
          },
          "default": {},
          "description": "Settings to use with detect-secrets. Refer to the detect-secrets documentation for formatting information. By default, all plugins will be used and no filters are configured. scan_settings takes precedence over baseline_file",
          "title": "Scan Settings",
          "type": "object"
        },
        "severity_threshold": {
          "anyOf": [
            {
              "enum": [
                "ALL",
                "LOW",
                "MEDIUM",
                "HIGH",
                "CRITICAL"
              ],
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "Minimum severity level to consider findings as failures. This is a scanner-level override of the default severity-level within ASH of MEDIUM.",
          "title": "Severity Threshold"
        }
      },
      "title": "DetectSecretsScannerConfigOptions",
      "type": "object"
    },
    "GrypeScannerConfig": {
      "additionalProperties": true,
      "description": "Grype SAST scanner configuration.",
      "properties": {
        "enabled": {
          "default": true,
          "description": "Whether the custom scanner is enabled.",
          "title": "Enabled",
          "type": "boolean"
        },
        "name": {
          "const": "grype",
          "default": "grype",
          "title": "Name",
          "type": "string"
        },
        "options": {
          "$ref": "#/$defs/ScannerOptionsBase",
          "default": {
            "severity_threshold": null
          },
          "description": "Configure Grype scanner"
        },
        "type": {
          "default": "SAST",
          "enum": [
            "CONTAINER",
            "DAST",
            "DEPENDENCY",
            "IAC",
            "SAST",
            "SBOM",
            "SECRETS",
            "UNKNOWN",
            "CUSTOM"
          ],
          "title": "Type",
          "type": "string"
        }
      },
      "title": "GrypeScannerConfig",
      "type": "object"
    },
    "HTMLReporterConfig": {
      "additionalProperties": true,
      "properties": {
        "enabled": {
          "default": true,
          "title": "Enabled",
          "type": "boolean"
        },
        "extension": {
          "default": "html",
          "title": "Extension",
          "type": "string"
        },
        "name": {
          "const": "html",
          "default": "html",
          "title": "Name",
          "type": "string"
        },
        "options": {
          "$ref": "#/$defs/ScannerOptionsBase",
          "default": {
            "severity_threshold": null
          },
          "description": "Scanner options"
        }
      },
      "title": "HTMLReporterConfig",
      "type": "object"
    },
    "IgnorePathWithReason": {
      "description": "Represents a path exclusion entry.",
      "properties": {
        "path": {
          "description": "Path or pattern to exclude",
          "title": "Path",
          "type": "string"
        },
        "reason": {
          "description": "Reason for exclusion",
          "title": "Reason",
          "type": "string"
        }
      },
      "required": [
        "path",
        "reason"
      ],
      "title": "IgnorePathWithReason",
      "type": "object"
    },
    "JSONReporterConfig": {
      "additionalProperties": true,
      "properties": {
        "enabled": {
          "default": false,
          "title": "Enabled",
          "type": "boolean"
        },
        "extension": {
          "default": "json",
          "title": "Extension",
          "type": "string"
        },
        "name": {
          "const": "json",
          "default": "json",
          "title": "Name",
          "type": "string"
        },
        "options": {
          "$ref": "#/$defs/ScannerOptionsBase",
          "default": {
            "severity_threshold": null
          },
          "description": "Scanner options"
        }
      },
      "title": "JSONReporterConfig",
      "type": "object"
    },
    "JUnitXMLReporterConfig": {
      "additionalProperties": true,
      "properties": {
        "enabled": {
          "default": true,
          "title": "Enabled",
          "type": "boolean"
        },
        "extension": {
          "default": "junit.xml",
          "title": "Extension",
          "type": "string"
        },
        "name": {
          "const": "junitxml",
          "default": "junitxml",
          "title": "Name",
          "type": "string"
        },
        "options": {
          "$ref": "#/$defs/ScannerOptionsBase",
          "default": {
            "severity_threshold": null
          },
          "description": "Scanner options"
        }
      },
      "title": "JUnitXMLReporterConfig",
      "type": "object"
    },
    "NpmAuditScannerConfig": {
      "additionalProperties": true,
      "description": "JS/TS Dependency scanner configuration.",
      "properties": {
        "enabled": {
          "default": true,
          "description": "Whether the custom scanner is enabled.",
          "title": "Enabled",
          "type": "boolean"
        },
        "name": {
          "const": "npm-audit",
          "default": "npm-audit",
          "title": "Name",
          "type": "string"
        },
        "options": {
          "$ref": "#/$defs/ScannerOptionsBase",
          "default": {
            "severity_threshold": null
          },
          "description": "Enable NPM/PNPM/Yarn Audit dependency scanner"
        },
        "type": {
          "default": "DEPENDENCY",
          "enum": [
            "CONTAINER",
            "DAST",
            "DEPENDENCY",
            "IAC",
            "SAST",
            "SBOM",
            "SECRETS",
            "UNKNOWN",
            "CUSTOM"
          ],
          "title": "Type",
          "type": "string"
        }
      },
      "title": "NpmAuditScannerConfig",
      "type": "object"
    },
    "OCSFReporterConfig": {
      "additionalProperties": true,
      "properties": {
        "enabled": {
          "default": true,
          "title": "Enabled",
          "type": "boolean"
        },
        "extension": {
          "default": "ocsf.json",
          "title": "Extension",
          "type": "string"
        },
        "name": {
          "const": "ocsf",
          "default": "ocsf",
          "title": "Name",
          "type": "string"
        },
        "options": {
          "$ref": "#/$defs/ScannerOptionsBase",
          "default": {
            "severity_threshold": null
          },
          "description": "Scanner options"
        }
      },
      "title": "OCSFReporterConfig",
      "type": "object"
    },
    "PluginContext": {
      "description": "Context container for plugins to ensure consistent path information.",
      "properties": {
        "output_dir": {
          "description": "Output directory for results",
          "format": "path",
          "title": "Output Dir",
          "type": "string"
        },
        "source_dir": {
          "description": "Source directory to scan",
          "format": "path",
          "title": "Source Dir",
          "type": "string"
        },
        "work_dir": {
          "default": null,
          "description": "Working directory for temporary files",
          "format": "path",
          "title": "Work Dir",
          "type": "string"
        }
      },
      "required": [
        "source_dir",
        "output_dir"
      ],
      "title": "PluginContext",
      "type": "object"
    },
    "ReporterConfigSegment": {
      "additionalProperties": {
        "anyOf": [
          {},
          {
            "$ref": "#/$defs/ReporterPluginConfigBase"
          }
        ]
      },
      "properties": {
        "asff": {
          "$ref": "#/$defs/ASFFReporterConfig",
          "default": {
            "enabled": false,
            "extension": "asff",
            "name": "asff",
            "options": {
              "severity_threshold": null
            }
          },
          "description": "Configure the options for the ASFF reporter"
        },
        "csv": {
          "$ref": "#/$defs/CSVReporterConfig",
          "default": {
            "enabled": false,
            "extension": "csv",
            "name": "csv",
            "options": {
              "severity_threshold": null
            }
          },
          "description": "Configure the options for the CSV reporter"
        },
        "cyclonedx": {
          "$ref": "#/$defs/CycloneDXReporterConfig",
          "default": {
            "enabled": true,
            "extension": "cdx.json",
            "name": "cyclonedx",
            "options": {
              "severity_threshold": null
            }
          },
          "description": "Configure the options for the CycloneDX reporter"
        },
        "html": {
          "$ref": "#/$defs/HTMLReporterConfig",
          "default": {
            "enabled": true,
            "extension": "html",
            "name": "html",
            "options": {
              "severity_threshold": null
            }
          },
          "description": "Configure the options for the HTML reporter"
        },
        "json": {
          "$ref": "#/$defs/JSONReporterConfig",
          "default": {
            "enabled": false,
            "extension": "json",
            "name": "json",
            "options": {
              "severity_threshold": null
            }
          },
          "description": "Configure the options for the JSON reporter"
        },
        "junitxml": {
          "$ref": "#/$defs/JUnitXMLReporterConfig",
          "default": {
            "enabled": true,
            "extension": "junit.xml",
            "name": "junitxml",
            "options": {
              "severity_threshold": null
            }
          },
          "description": "Configure the options for the JUnit XML reporter"
        },
        "ocsf": {
          "$ref": "#/$defs/OCSFReporterConfig",
          "default": {
            "enabled": true,
            "extension": "ocsf.json",
            "name": "ocsf",
            "options": {
              "severity_threshold": null
            }
          },
          "description": "Configure the options for the OCSF reporter"
        },
        "sarif": {
          "$ref": "#/$defs/SARIFReporterConfig",
          "default": {
            "enabled": true,
            "extension": "sarif",
            "name": "sarif",
            "options": {
              "severity_threshold": null
            }
          },
          "description": "Configure the options for the SARIF reporter"
        },
        "spdx": {
          "$ref": "#/$defs/SPDXReporterConfig",
          "default": {
            "enabled": false,
            "extension": "spdx.json",
            "name": "spdx",
            "options": {
              "severity_threshold": null
            }
          },
          "description": "Configure the options for the SPDX reporter"
        },
        "text": {
          "$ref": "#/$defs/TextReporterConfig",
          "default": {
            "enabled": true,
            "extension": "txt",
            "name": "text",
            "options": {
              "severity_threshold": null
            }
          },
          "description": "Configure the options for the Text reporter"
        },
        "yaml": {
          "$ref": "#/$defs/YAMLReporterConfig",
          "default": {
            "enabled": false,
            "extension": "yaml",
            "name": "yaml",
            "options": {
              "severity_threshold": null
            }
          },
          "description": "Configure the options for the YAML reporter"
        }
      },
      "title": "ReporterConfigSegment",
      "type": "object"
    },
    "ReporterPluginConfigBase": {
      "additionalProperties": true,
      "properties": {
        "enabled": {
          "default": true,
          "description": "Whether the component is enabled",
          "title": "Enabled",
          "type": "boolean"
        },
        "extension": {
          "anyOf": [
            {
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "title": "Extension"
        },
        "name": {
          "default": null,
          "description": "Name of the component using letters, numbers, underscores and hyphens. Must begin with a letter.",
          "minLength": 1,
          "pattern": "^[a-zA-Z][\\w-]+$",
          "title": "Name",
          "type": "string"
        },
        "options": {
          "$ref": "#/$defs/ScannerOptionsBase",
          "default": {
            "severity_threshold": null
          },
          "description": "Scanner options"
        }
      },
      "title": "ReporterPluginConfigBase",
      "type": "object"
    },
    "SARIFReporterConfig": {
      "additionalProperties": true,
      "properties": {
        "enabled": {
          "default": true,
          "title": "Enabled",
          "type": "boolean"
        },
        "extension": {
          "default": "sarif",
          "title": "Extension",
          "type": "string"
        },
        "name": {
          "const": "sarif",
          "default": "sarif",
          "title": "Name",
          "type": "string"
        },
        "options": {
          "$ref": "#/$defs/ScannerOptionsBase",
          "default": {
            "severity_threshold": null
          },
          "description": "Scanner options"
        }
      },
      "title": "SARIFReporterConfig",
      "type": "object"
    },
    "SPDXReporterConfig": {
      "additionalProperties": true,
      "properties": {
        "enabled": {
          "default": false,
          "title": "Enabled",
          "type": "boolean"
        },
        "extension": {
          "default": "spdx.json",
          "title": "Extension",
          "type": "string"
        },
        "name": {
          "const": "spdx",
          "default": "spdx",
          "title": "Name",
          "type": "string"
        },
        "options": {
          "$ref": "#/$defs/ScannerOptionsBase",
          "default": {
            "severity_threshold": null
          },
          "description": "Scanner options"
        }
      },
      "title": "SPDXReporterConfig",
      "type": "object"
    },
    "ScannerConfigSegment": {
      "additionalProperties": {
        "anyOf": [
          {},
          {
            "$ref": "#/$defs/CustomScannerConfig"
          }
        ]
      },
      "properties": {
        "bandit": {
          "$ref": "#/$defs/BanditScannerConfig",
          "default": {
            "enabled": true,
            "name": "bandit",
            "options": {
              "additional_formats": [],
              "confidence_level": "all",
              "excluded_paths": [],
              "ignore_nosec": false,
              "severity_threshold": null
            }
          },
          "description": "Configure the options for Bandit"
        },
        "cdk-nag": {
          "$ref": "#/$defs/CdkNagScannerConfig",
          "default": {
            "enabled": true,
            "name": "cdk-nag",
            "options": {
              "nag_packs": {
                "AwsSolutionsChecks": true,
                "HIPAASecurityChecks": false,
                "NIST80053R4Checks": false,
                "NIST80053R5Checks": false,
                "PCIDSS321Checks": false
              },
              "severity_threshold": null
            }
          },
          "description": "Configure the options for CdkNag"
        },
        "cfn-nag": {
          "$ref": "#/$defs/CfnNagScannerConfig",
          "default": {
            "enabled": true,
            "name": "cfn-nag",
            "options": {
              "severity_threshold": null
            },
            "type": "IAC"
          },
          "description": "Configure the options for CfnNag"
        },
        "checkov": {
          "$ref": "#/$defs/CheckovScannerConfig",
          "default": {
            "enabled": true,
            "name": "checkov",
            "options": {
              "additional_formats": [
                "cyclonedx_json"
              ],
              "config_file": null,
              "frameworks": [
                "all"
              ],
              "severity_threshold": null,
              "skip_frameworks": [],
              "skip_path": []
            }
          },
          "description": "Configure the options for Checkov"
        },
        "detect-secrets": {
          "$ref": "#/$defs/DetectSecretsScannerConfig",
          "default": {
            "enabled": true,
            "name": "detect-secrets",
            "options": {
              "baseline_file": null,
              "scan_settings": {},
              "severity_threshold": null
            }
          },
          "description": "Configure the options for DetectSecrets"
        },
        "grype": {
          "$ref": "#/$defs/GrypeScannerConfig",
          "default": {
            "enabled": true,
            "name": "grype",
            "options": {
              "severity_threshold": null
            },
            "type": "SAST"
          },
          "description": "Configure the options for Grype"
        },
        "npm-audit": {
          "$ref": "#/$defs/NpmAuditScannerConfig",
          "default": {
            "enabled": true,
            "name": "npm-audit",
            "options": {
              "severity_threshold": null
            },
            "type": "DEPENDENCY"
          },
          "description": "Configure the options for NpmAudit"
        },
        "semgrep": {
          "$ref": "#/$defs/SemgrepScannerConfig",
          "default": {
            "enabled": true,
            "name": "semgrep",
            "options": {
              "severity_threshold": null
            },
            "type": "SAST"
          },
          "description": "Configure the options for Semgrep"
        },
        "syft": {
          "$ref": "#/$defs/SyftScannerConfig",
          "default": {
            "enabled": true,
            "name": "syft",
            "options": {
              "severity_threshold": null
            },
            "type": "SBOM"
          },
          "description": "Configure the options for Syft"
        }
      },
      "title": "ScannerConfigSegment",
      "type": "object"
    },
    "ScannerOptionsBase": {
      "additionalProperties": true,
      "description": "Base class for scanner options.",
      "properties": {
        "severity_threshold": {
          "anyOf": [
            {
              "enum": [
                "ALL",
                "LOW",
                "MEDIUM",
                "HIGH",
                "CRITICAL"
              ],
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "Minimum severity level to consider findings as failures. This is a scanner-level override of the default severity-level within ASH of MEDIUM.",
          "title": "Severity Threshold"
        }
      },
      "title": "ScannerOptionsBase",
      "type": "object"
    },
    "ScannerPluginBase": {
      "additionalProperties": true,
      "description": "Base class for all scanner plugins.",
      "properties": {
        "args": {
          "$ref": "#/$defs/ToolArgs",
          "default": {
            "extra_args": [],
            "format_arg": null,
            "format_arg_value": null,
            "output_arg": null,
            "scan_path_arg": null
          },
          "description": "Specialized arguments to pass to the scanner command. Includes an `extra_args` field which accepts a dictionary of arbitrary arguments to pass to the scanner. These are not configurable at scan time."
        },
        "command": {
          "default": null,
          "description": "The command to invoke the scanner, typically the binary or path to a script",
          "title": "Command",
          "type": "string"
        },
        "config": {
          "anyOf": [
            {
              "$ref": "#/$defs/ScannerPluginConfigBase"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "title": "Config"
        },
        "context": {
          "anyOf": [
            {
              "$ref": "#/$defs/PluginContext"
            },
            {
              "type": "null"
            }
          ],
          "default": null
        },
        "description": {
          "anyOf": [
            {
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "title": "Description"
        },
        "end_time": {
          "anyOf": [
            {
              "format": "date-time",
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "title": "End Time"
        },
        "errors": {
          "default": [],
          "items": {
            "type": "string"
          },
          "title": "Errors",
          "type": "array"
        },
        "exit_code": {
          "default": 0,
          "title": "Exit Code",
          "type": "integer"
        },
        "output": {
          "default": [],
          "items": {
            "type": "string"
          },
          "title": "Output",
          "type": "array"
        },
        "output_dir": {
          "anyOf": [
            {
              "format": "path",
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "title": "Output Dir"
        },
        "results_dir": {
          "anyOf": [
            {
              "format": "path",
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "title": "Results Dir"
        },
        "results_file": {
          "anyOf": [
            {
              "format": "path",
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "title": "Results File"
        },
        "source_dir": {
          "anyOf": [
            {
              "format": "path",
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "title": "Source Dir"
        },
        "start_time": {
          "anyOf": [
            {
              "format": "date-time",
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "title": "Start Time"
        },
        "subcommands": {
          "default": [],
          "description": "Subcommands to include when invoking the scanner, e.g. ['scan'] is needed as the subcommand for 'semgrep' as Semgrep supports multiple subcommands, but we are specifically interested in running a scan.",
          "items": {
            "type": "string"
          },
          "title": "Subcommands",
          "type": "array"
        },
        "tool_type": {
          "default": "UNKNOWN",
          "title": "Tool Type",
          "type": "string"
        },
        "tool_version": {
          "anyOf": [
            {
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "title": "Tool Version"
        },
        "work_dir": {
          "anyOf": [
            {
              "format": "path",
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "title": "Work Dir"
        }
      },
      "title": "ScannerPluginBase",
      "type": "object"
    },
    "ScannerPluginConfigBase": {
      "additionalProperties": true,
      "properties": {
        "enabled": {
          "default": true,
          "description": "Whether the component is enabled",
          "title": "Enabled",
          "type": "boolean"
        },
        "name": {
          "default": null,
          "description": "Name of the component using letters, numbers, underscores and hyphens. Must begin with a letter.",
          "minLength": 1,
          "pattern": "^[a-zA-Z][\\w-]+$",
          "title": "Name",
          "type": "string"
        },
        "options": {
          "$ref": "#/$defs/ScannerOptionsBase",
          "default": {
            "severity_threshold": null
          },
          "description": "Scanner options"
        }
      },
      "title": "ScannerPluginConfigBase",
      "type": "object"
    },
    "SemgrepScannerConfig": {
      "additionalProperties": true,
      "description": "Semgrep SAST scanner configuration.",
      "properties": {
        "enabled": {
          "default": true,
          "description": "Whether the custom scanner is enabled.",
          "title": "Enabled",
          "type": "boolean"
        },
        "name": {
          "const": "semgrep",
          "default": "semgrep",
          "title": "Name",
          "type": "string"
        },
        "options": {
          "$ref": "#/$defs/ScannerOptionsBase",
          "default": {
            "severity_threshold": null
          },
          "description": "Configure Semgrep scanner"
        },
        "type": {
          "default": "SAST",
          "enum": [
            "CONTAINER",
            "DAST",
            "DEPENDENCY",
            "IAC",
            "SAST",
            "SBOM",
            "SECRETS",
            "UNKNOWN",
            "CUSTOM"
          ],
          "title": "Type",
          "type": "string"
        }
      },
      "title": "SemgrepScannerConfig",
      "type": "object"
    },
    "SyftScannerConfig": {
      "additionalProperties": true,
      "description": "Syft SBOM scanner configuration.",
      "properties": {
        "enabled": {
          "default": true,
          "description": "Whether the custom scanner is enabled.",
          "title": "Enabled",
          "type": "boolean"
        },
        "name": {
          "const": "syft",
          "default": "syft",
          "title": "Name",
          "type": "string"
        },
        "options": {
          "$ref": "#/$defs/ScannerOptionsBase",
          "default": {
            "severity_threshold": null
          },
          "description": "Configure Syft scanner"
        },
        "type": {
          "default": "SBOM",
          "enum": [
            "CONTAINER",
            "DAST",
            "DEPENDENCY",
            "IAC",
            "SAST",
            "SBOM",
            "SECRETS",
            "UNKNOWN",
            "CUSTOM"
          ],
          "title": "Type",
          "type": "string"
        }
      },
      "title": "SyftScannerConfig",
      "type": "object"
    },
    "TextReporterConfig": {
      "additionalProperties": true,
      "properties": {
        "enabled": {
          "default": true,
          "title": "Enabled",
          "type": "boolean"
        },
        "extension": {
          "default": "txt",
          "title": "Extension",
          "type": "string"
        },
        "name": {
          "const": "text",
          "default": "text",
          "title": "Name",
          "type": "string"
        },
        "options": {
          "$ref": "#/$defs/ScannerOptionsBase",
          "default": {
            "severity_threshold": null
          },
          "description": "Scanner options"
        }
      },
      "title": "TextReporterConfig",
      "type": "object"
    },
    "ToolArgs": {
      "additionalProperties": true,
      "description": "Base class for tool argument dictionaries.",
      "properties": {
        "extra_args": {
          "default": [],
          "items": {
            "$ref": "#/$defs/ToolExtraArg"
          },
          "title": "Extra Args",
          "type": "array"
        },
        "format_arg": {
          "anyOf": [
            {
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "title": "Format Arg"
        },
        "format_arg_value": {
          "anyOf": [
            {
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "title": "Format Arg Value"
        },
        "output_arg": {
          "anyOf": [
            {
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "title": "Output Arg"
        },
        "scan_path_arg": {
          "anyOf": [
            {
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "title": "Scan Path Arg"
        }
      },
      "title": "ToolArgs",
      "type": "object"
    },
    "ToolExtraArg": {
      "additionalProperties": false,
      "properties": {
        "key": {
          "title": "Key",
          "type": "string"
        },
        "value": {
          "anyOf": [
            {
              "type": "string"
            },
            {
              "type": "integer"
            },
            {
              "type": "number"
            },
            {
              "type": "boolean"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "title": "Value"
        }
      },
      "required": [
        "key"
      ],
      "title": "ToolExtraArg",
      "type": "object"
    },
    "YAMLReporterConfig": {
      "additionalProperties": true,
      "properties": {
        "enabled": {
          "default": false,
          "title": "Enabled",
          "type": "boolean"
        },
        "extension": {
          "default": "yaml",
          "title": "Extension",
          "type": "string"
        },
        "name": {
          "const": "yaml",
          "default": "yaml",
          "title": "Name",
          "type": "string"
        },
        "options": {
          "$ref": "#/$defs/ScannerOptionsBase",
          "default": {
            "severity_threshold": null
          },
          "description": "Scanner options"
        }
      },
      "title": "YAMLReporterConfig",
      "type": "object"
    }
  },
  "additionalProperties": true,
  "description": "Main configuration model for Automated Security Helper.",
  "properties": {
    "build": {
      "$ref": "#/$defs/BuildConfig",
      "default": {
        "build_mode": "OFFLINE",
        "custom_scanners": [],
        "tool_install_scripts": {}
      },
      "description": "Build-time configuration settings"
    },
    "converters": {
      "additionalProperties": {
        "type": "boolean"
      },
      "default": {
        "archive": true,
        "jupyter": true
      },
      "description": "The map of converters and a boolean value indicating whether they should be enabled or disabled",
      "title": "Converters",
      "type": "object"
    },
    "external_reports_to_include": {
      "default": [],
      "description": "List of external reports to include in the final report. These can be SARIF, CycloneDX, or CDK synth paths that have produced NagReport CSVs or JSON files.",
      "items": {
        "type": "string"
      },
      "title": "External Reports To Include",
      "type": "array"
    },
    "fail_on_findings": {
      "default": true,
      "description": "Whether to exit with non-zero code if findings are detected",
      "title": "Fail On Findings",
      "type": "boolean"
    },
    "global_settings": {
      "$ref": "#/$defs/AshGlobalDefaultsConfigSection",
      "default": {
        "ignore_paths": [],
        "severity_threshold": "MEDIUM"
      },
      "description": "Global default settings for ASH shared across scanners. If the same setting exists at the scanner level and is set in both places, the scanner level settings take precedence."
    },
    "max_concurrent_scanners": {
      "default": 4,
      "description": "Maximum number of scanners to run concurrently",
      "minimum": 1,
      "title": "Max Concurrent Scanners",
      "type": "integer"
    },
    "no_cleanup": {
      "default": false,
      "description": "Whether to keep the work directory after scanning",
      "title": "No Cleanup",
      "type": "boolean"
    },
    "output_dir": {
      "default": "ash_output",
      "description": "Directory to store scan outputs",
      "title": "Output Dir",
      "type": "string"
    },
    "project_name": {
      "default": "ash-target",
      "description": "Name of the project being scanned",
      "title": "Project Name",
      "type": "string"
    },
    "reporters": {
      "$ref": "#/$defs/ReporterConfigSegment",
      "default": {
        "asff": {
          "enabled": false,
          "extension": "asff",
          "name": "asff",
          "options": {
            "severity_threshold": null
          }
        },
        "csv": {
          "enabled": false,
          "extension": "csv",
          "name": "csv",
          "options": {
            "severity_threshold": null
          }
        },
        "cyclonedx": {
          "enabled": true,
          "extension": "cdx.json",
          "name": "cyclonedx",
          "options": {
            "severity_threshold": null
          }
        },
        "html": {
          "enabled": true,
          "extension": "html",
          "name": "html",
          "options": {
            "severity_threshold": null
          }
        },
        "json": {
          "enabled": false,
          "extension": "json",
          "name": "json",
          "options": {
            "severity_threshold": null
          }
        },
        "junitxml": {
          "enabled": true,
          "extension": "junit.xml",
          "name": "junitxml",
          "options": {
            "severity_threshold": null
          }
        },
        "ocsf": {
          "enabled": true,
          "extension": "ocsf.json",
          "name": "ocsf",
          "options": {
            "severity_threshold": null
          }
        },
        "sarif": {
          "enabled": true,
          "extension": "sarif",
          "name": "sarif",
          "options": {
            "severity_threshold": null
          }
        },
        "spdx": {
          "enabled": false,
          "extension": "spdx.json",
          "name": "spdx",
          "options": {
            "severity_threshold": null
          }
        },
        "text": {
          "enabled": true,
          "extension": "txt",
          "name": "text",
          "options": {
            "severity_threshold": null
          }
        },
        "yaml": {
          "enabled": false,
          "extension": "yaml",
          "name": "yaml",
          "options": {
            "severity_threshold": null
          }
        }
      },
      "description": "Reporter configurations by name."
    },
    "scanners": {
      "$ref": "#/$defs/ScannerConfigSegment",
      "default": {
        "bandit": {
          "enabled": true,
          "name": "bandit",
          "options": {
            "additional_formats": [],
            "confidence_level": "all",
            "excluded_paths": [],
            "ignore_nosec": false,
            "severity_threshold": null
          }
        },
        "cdk-nag": {
          "enabled": true,
          "name": "cdk-nag",
          "options": {
            "nag_packs": {
              "AwsSolutionsChecks": true,
              "HIPAASecurityChecks": false,
              "NIST80053R4Checks": false,
              "NIST80053R5Checks": false,
              "PCIDSS321Checks": false
            },
            "severity_threshold": null
          }
        },
        "cfn-nag": {
          "enabled": true,
          "name": "cfn-nag",
          "options": {
            "severity_threshold": null
          },
          "type": "IAC"
        },
        "checkov": {
          "enabled": true,
          "name": "checkov",
          "options": {
            "additional_formats": [
              "cyclonedx_json"
            ],
            "config_file": null,
            "frameworks": [
              "all"
            ],
            "severity_threshold": null,
            "skip_frameworks": [],
            "skip_path": []
          }
        },
        "detect-secrets": {
          "enabled": true,
          "name": "detect-secrets",
          "options": {
            "baseline_file": null,
            "scan_settings": {},
            "severity_threshold": null
          }
        },
        "grype": {
          "enabled": true,
          "name": "grype",
          "options": {
            "severity_threshold": null
          },
          "type": "SAST"
        },
        "npm-audit": {
          "enabled": true,
          "name": "npm-audit",
          "options": {
            "severity_threshold": null
          },
          "type": "DEPENDENCY"
        },
        "semgrep": {
          "enabled": true,
          "name": "semgrep",
          "options": {
            "severity_threshold": null
          },
          "type": "SAST"
        },
        "syft": {
          "enabled": true,
          "name": "syft",
          "options": {
            "severity_threshold": null
          },
          "type": "SBOM"
        }
      },
      "description": "Scanner configurations by name."
    }
  },
  "title": "ASHConfig",
  "type": "object"
}
