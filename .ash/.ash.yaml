# yaml-language-server: $schema=../automated_security_helper/schemas/AshConfig.json
project_name: automated-security-helper
global_settings:
  severity_threshold: MEDIUM
  ignore_paths:
  - path: '**/.venv/**'
    reason: Virtual environment, not committed, only 3p content
    expiration: null
  - path: tests/test_data/**
    reason: This is test data that is used during unit testing only and is not part
      of the core application.
    expiration: null
  - path: .poetry/**
    reason: Local plugin configuration for Poetry plugins
    expiration: null
  - path: automated_security_helper/assets/ASH_COMMIT*
    reason: This file is generated by the build process and does not contain any secrets
      or sensitive information.
    expiration: null
  - path: tests/pytest-temp
    reason: This is temporary data that is generated during unit testing only and
      is not part of the core application.
    expiration: null
  - path: '**/automated_security_helper/schemas/AshAggregatedResults.json'
    reason: This file is generated by a corresponding Pydantic model and does not
      contain any secrets or sensitive information. Findings on this file are false
      positives and should be addressed on the related Pydantic models, not on this
      JSON file.
    expiration: null
  - path: '**/automated_security_helper/schemas/AshConfig.json'
    reason: This file is generated by a corresponding Pydantic model and does not
      contain any secrets or sensitive information. Findings on this file are false
      positives and should be addressed on the related Pydantic models, not on this
      JSON file.
    expiration: null
  suppressions:
  - path: tests/unit/plugin_modules/ash_aws_plugins/test_cloudwatch_logs_reporter*
    reason: False positive, dummy test data and not an actual secret.
    expiration: null
    rule_id: SECRET-SECRET-KEYWORD
    line_start: null
    line_end: null
  - path: .github/workflows/run-ash-security-scan.yml
    reason: Troubleshooting swapping from direct injection to evaluating interpolated
      env vars
    expiration: '2025-07-01'
    rule_id: yaml.github-actions.security.run-shell-injection.run-shell-injection
    line_start: null
    line_end: null
  - path: tests/**/*.py
    reason: Assert usage expected with Pytest
    expiration: null
    rule_id: B101
    line_start: null
    line_end: null
  - path: tests/utils/*.py
    reason: Test facilities and tooling used to generate randomness during testing.
    expiration: null
    rule_id: B311
    line_start: null
    line_end: null
  - path: tests/unit/utils/*.py
    reason: Temp file path as string, not actual temp dir usage.
    expiration: null
    rule_id: B108
    line_start: null
    line_end: null
  - path: tests/**/*.py
    reason: Subprocess module used across test suite due to the nature of ASH itself
      being a tool orchestrator. These instances are in test suites and not in the
      code used at runtime.
    expiration: null
    rule_id: B404
    line_start: null
    line_end: null
  - path: tests/**/*.py
    reason: Subprocess module used across test suite due to the nature of ASH itself
      being a tool orchestrator. These instances are in test suites and not in the
      code used at runtime.
    expiration: null
    rule_id: B603
    line_start: null
    line_end: null
  - path: tests/**/*.py
    reason: Mocking and other test mechanisms. These instances are in test suites
      and not in the code used at runtime.
    expiration: null
    rule_id: B607
    line_start: null
    line_end: null
  - path: docs/content/docs/plugins/aws/index.md
    reason: False positive, not an actual secret
    expiration: null
    rule_id: SECRET-SECRET-KEYWORD
    line_start: null
    line_end: null
  - path: docs/content/docs/plugins/development-guide.md
    reason: False positive, not an actual secret
    expiration: null
    rule_id: SECRET-SECRET-KEYWORD
    line_start: null
    line_end: null
  - path: docs/content/docs/testing/examples/*
    reason: Documentation with test code examples focused on brevity.
    expiration: null
    rule_id: null
    line_start: null
    line_end: null
  - path: .ash/ash_output*/*.*
    reason: False positive - ASH output files contain hashes and IDs that trigger
      entropy detection
    expiration: null
    rule_id: SECRET-HEX-HIGH-ENTROPY-STRING
    line_start: null
    line_end: null
  - path: .ash/ash_output*/reports/*.json
    reason: False positive - ASH output files contain hashes and IDs that trigger
      entropy detection
    expiration: null
    rule_id: SECRET-HEX-HIGH-ENTROPY-STRING
    line_start: null
    line_end: null
  - path: .ash/ash_output*/scanners/*.json
    reason: False positive - ASH output files contain hashes and IDs that trigger
      entropy detection
    expiration: null
    rule_id: SECRET-HEX-HIGH-ENTROPY-STRING
    line_start: null
    line_end: null
  - path: .poetry/plugins/config.toml
    reason: False positive - Poetry plugins config contains legitimate hash values
    expiration: null
    rule_id: SECRET-HEX-HIGH-ENTROPY-STRING
    line_start: null
    line_end: null
  - path: .poetry/plugins/config.toml
    reason: False positive - Poetry plugins config contains legitimate hash values
    expiration: null
    rule_id: SECRET-HEX-HIGH-ENTROPY-STRING
    line_start: null
    line_end: null
  - path: poetry.lock
    reason: Current pending upgrade from Checkov as the latest version is still pinning
      the insecure version of asteval
    expiration: '2025-07-01'
    rule_id: GHSA-3wwr-3g9f-9gc7-asteval
    line_start: null
    line_end: null
  - path: poetry.lock
    reason: Current pending upgrade from Checkov as the latest version is still pinning
      the insecure version of asteval
    expiration: '2025-07-01'
    rule_id: GHSA-vp47-9734-prjw-asteval
    line_start: null
    line_end: null
fail_on_findings: true
ash_plugin_modules:
- automated_security_helper.plugin_modules.ash_aws_plugins
external_reports_to_include: []
build: null
converters:
  archive:
    name: archive
    enabled: true
    options: {}
  jupyter:
    name: jupyter
    enabled: true
    options: {}
scanners:
  bandit:
    name: bandit
    enabled: true
    options:
      severity_threshold: null
      config_file: .ash/bandit.yaml
      confidence_level: all
      ignore_nosec: false
      excluded_paths: []
      additional_formats: []
  cdk-nag:
    name: cdk-nag
    enabled: true
    options:
      severity_threshold: null
      nag_packs:
        AwsSolutionsChecks: true
        HIPAASecurityChecks: false
        NIST80053R4Checks: false
        NIST80053R5Checks: false
        PCIDSS321Checks: false
  cfn-nag:
    name: cfn-nag
    enabled: true
    options:
      severity_threshold: null
  checkov:
    name: checkov
    enabled: true
    options:
      severity_threshold: LOW
      config_file: .ash/.checkov.yaml
      skip_path: []
      additional_formats: []
      offline: false
      frameworks:
      - all
      skip_frameworks: []
  detect-secrets:
    name: detect-secrets
    enabled: true
    options:
      severity_threshold: null
      baseline_file: null
      scan_settings:
        version: null
        generated_at: null
        plugins_used: []
        filters_used: []
        results: {}
  grype:
    name: grype
    enabled: true
    options:
      severity_threshold: null
      config_file: .ash/.grype.yaml
      offline: false
  npm-audit:
    name: npm-audit
    enabled: true
    options:
      severity_threshold: null
      offline: false
  opengrep:
    name: opengrep
    enabled: true
    options:
      severity_threshold: null
      config: auto
      exclude:
      - '*-converted.py'
      - '*_report_result.txt'
      exclude_rule: []
      severity: []
      metrics: auto
      offline: false
      patterns: []
      version: v1.1.5
  semgrep:
    name: semgrep
    enabled: true
    options:
      severity_threshold: null
      config: auto
      exclude:
      - '*-converted.py'
      - '*_report_result.txt'
      exclude_rule: []
      severity: []
      metrics: auto
      offline: false
  syft:
    name: syft
    enabled: true
    options:
      severity_threshold: null
      config_file: null
      exclude: []
      additional_outputs:
      - syft-table
  cdk_nag:
    name: cdk-nag
    enabled: true
    options:
      severity_threshold: null
      nag_packs:
        AwsSolutionsChecks: true
        HIPAASecurityChecks: true
        NIST80053R4Checks: true
        NIST80053R5Checks: true
        PCIDSS321Checks: true
  cfn_nag:
    name: cfn-nag
    enabled: true
    options:
      severity_threshold: null
  detect_secrets:
    name: detect-secrets
    enabled: true
    options:
      severity_threshold: null
      baseline_file: null
      scan_settings:
        version: null
        generated_at: null
        plugins_used: []
        filters_used: []
        results: {}
  npm_audit:
    name: npm-audit
    enabled: true
    options:
      severity_threshold: null
      offline: false
reporters:
  csv:
    name: csv
    enabled: true
    options: {}
    extension: csv
  cyclonedx:
    name: cyclonedx
    enabled: true
    options: {}
    extension: cdx.json
  html:
    name: html
    enabled: true
    options: {}
    extension: html
  flat-json:
    name: flat-json
    enabled: true
    options: {}
    extension: flat.json
  gitlab-sast:
    name: gitlab-sast
    enabled: true
    options: {}
    extension: gl-sast-report.json
  junitxml:
    name: junitxml
    enabled: true
    options: {}
    extension: junit.xml
  markdown:
    name: markdown
    enabled: true
    options:
      include_summary: true
      include_findings_table: false
      include_detailed_findings: true
      max_detailed_findings: 20
      top_hotspots_limit: 10
      use_collapsible_details: true
    extension: summary.md
  ocsf:
    name: ocsf
    enabled: true
    options: {}
    extension: ocsf.json
  sarif:
    name: sarif
    enabled: true
    options: {}
    extension: sarif
  spdx:
    name: spdx
    enabled: false
    options: {}
    extension: spdx.json
  text:
    name: text
    enabled: true
    options:
      include_summary: true
      include_findings_table: false
      include_detailed_findings: false
      max_detailed_findings: 20
      top_hotspots_limit: 20
    extension: summary.txt
  yaml:
    name: yaml
    enabled: false
    options: {}
    extension: yaml
  flat_json:
    name: flat-json
    enabled: true
    options: {}
    extension: flat.json
  gitlab_sast:
    name: gitlab-sast
    enabled: true
    options: {}
    extension: gl-sast-report.json
  security-hub:
    enabled: false
  cloudwatch-logs:
    enabled: false
    options:
      aws_region: us-west-2
      log_group_name: ash-log-group-testing
  s3:
    enabled: false
    options:
      aws_region: us-west-2
      bucket_name: null
      bucket_prefix: null
