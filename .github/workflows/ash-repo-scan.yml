#checkov:skip=CKV2_GHA_1:The permissions are not set to write-all at the top-level, or any level
name: Run ASH
on:
  push:
    branches:
      - "*"
    tags:
      - "*"
  pull_request:
    branches:
      - "*"
  workflow_dispatch: {}
env:
  PYTHON_VERSION: "3.12"
jobs:
  ash:
    name: Run ASH Security Scan
    permissions:
      #checkov:skip=CKV2_GHA_1:The permissions are not set to write-all at the top-level, or any level
      contents: read
      checks: write
      security-events: write
      pull-requests: write
      statuses: write
    uses: awslabs/automated-security-helper/.github/workflows/run-ash-security-scan.yml@v3/feat/add-gh-action
    with:
      ash-version: ${{ github.sha }}
      fail-on-findings: false
      post-pr-comment: true
      repository-owner: ${{ github.repository_owner }}
      verbose: true
      python-version: '3.12'
      ash-mode: container
      ash-args: '--inspect'
